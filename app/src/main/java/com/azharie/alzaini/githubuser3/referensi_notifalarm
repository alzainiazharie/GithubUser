    package com.example.githubuserbfaa

    import android.app.AlarmManager
    import android.app.NotificationChannel
    import android.app.NotificationManager
    import android.content.BroadcastReceiver
    import android.content.Context
    import android.content.Intent
    import android.content.SharedPreferences
    import android.media.RingtoneManager
    import android.os.Build
    import androidx.appcompat.app.AppCompatActivity
    import android.os.Bundle
    import android.view.View
    import android.widget.Toast
    import androidx.core.app.NotificationCompat
    import androidx.core.content.ContextCompat
    import com.example.githubuserbfaa.databinding.ActivityReminderSettingBinding

    class ReminderSetting : AppCompatActivity() {
        companion object {
           private const val PREF_NAME = "SettingPref"
            private const val DAILY = "daily"
        }
        private var binding: ActivityReminderSettingBinding? = null
        private lateinit var alarmReceiver: AlarmReceiver
        private lateinit var mSharedPreferences: SharedPreferences

        override fun onCreate(savedInstanceState: Bundle?) {
            super.onCreate(savedInstanceState)

            alarmReceiver = AlarmReceiver()
            mSharedPreferences = getSharedPreferences(PREF_NAME, Context.MODE_PRIVATE)

            binding = ActivityReminderSettingBinding.inflate(layoutInflater)
            setContentView(binding?.root)

            setBtnAlarm()
            binding?.btnSwitchAlarm?.setOnCheckedChangeListener{ _, isChecked ->
                if (isChecked){
                    alarmReceiver.setRepeatingAlarm(applicationContext, AlarmReceiver.TYPE_REPEAT, "Daily Github Reminder!")
                } else {
                    alarmReceiver.cancelAlarm(applicationContext, AlarmReceiver.TYPE_REPEAT)
                }
                saveChek(isChecked)
            }
        }

        private fun saveChek(checked: Boolean) {
            val edit = mSharedPreferences.edit()
            edit.putBoolean(DAILY, checked)
            edit.apply()
        }

        private fun setBtnAlarm() {
            binding?.btnSwitchAlarm?.isChecked = mSharedPreferences.getBoolean(DAILY, false)
        }

    }